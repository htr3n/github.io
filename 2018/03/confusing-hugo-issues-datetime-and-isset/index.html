<!DOCTYPE html>
<html lang="en">
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Cache-Control" content="public" />
    <!-- Enable responsiveness on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="htr3n&#39;s blog :: technology, opinions, and rants about everything">
    <meta name="keywords" content="blog,java,php,python,golang,javascript,shell,thoughts,macos,apple,tiếng việt,parental,family,apache,httpd,laravel,politics,critical thinking,chính trị,luật,hiến pháp,xã hội,gia đình">
    <meta name="generator" content="Hugo 0.42.2" />
    
    <title>Confusing Hugo issues: datetime and &#39;isset&#39; &middot; htr3n&#39;s</title>
    <meta content="Confusing Hugo issues: datetime and &#39;isset&#39; - htr3n&#39;s" property="og:title">
    <meta content="htr3n&#39;s blog :: technology, opinions, and rants about everything - " property="og:description">
    <!-- CSS -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,400i|IBM+Plex+Sans+Condensed:400,500,600,700|Source+Code+Pro:400,400i" rel="stylesheet">
    <link rel="stylesheet" href="https://htr3n.github.io//css/print.min.css" media="print">
    <link rel="stylesheet" href="https://htr3n.github.io//css/poole.min.css">
    <link rel="stylesheet" href="https://htr3n.github.io//css/hyde.min.css">
    <!-- Font-Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/solid.css" integrity="sha384-TbilV5Lbhlwdyc4RuIV/JhD8NR+BfMrvz4BL5QFa2we1hQu6wvREr3v6XSRfCTRp" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/brands.css" integrity="sha384-7xAnn7Zm3QC1jFjVc1A6v/toepoG3JXboQYzbM0jrPzou9OFXm/fY6Z/XiIebl/k" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/fontawesome.css" integrity="sha384-ozJwkrqb90Oa3ZNb+yKFW2lToAWYdTiF1vt8JiH5ptTGHTGcN7qdoR1F95e0kYyG" crossorigin="anonymous">
    <!-- highlight.js-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/zenburn.min.css">
    <!-- Customised CSS -->
    <link rel="stylesheet" href="https://htr3n.github.io/css/hyde-hyde.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

    <body class=" ">
        <div class="sidebar">
  <div class="container text-center ">
    <div class="sidebar-about text-center">
      <a href="https://htr3n.github.io/"><h1 class="brand">htr3n&#39;s</h1></a>
       <img src="/img/avatar.png" alt="Author Image" class="img-circle headshot center"> 
      <p class="lead">
         technology, thoughts, opinions, rants 
      </p>
    </div>
    
<div>
	<ul class="sidebar-nav">
		
		
				<li>
					<a href="/posts/"> <span>Articles</span></a>
				</li>
				<li>
					<a href="/portfolio/"> <span>Portfolio</span></a>
				</li>
				<li>
					<a href="/vn/"> <span>Tiếng Việt</span></a>
				</li>
				<li>
					<a href="/about/"> <span>About Me</span></a>
				</li>
		</li>
	</ul>
</div>

    <p>
      <section class="row text-center">
	
	<a href="https://twitter.com/htr3n"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	&nbsp;<a href="https://github.com/htr3n"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://bitbucket.org/hoanghuytran"><i class="fab fa-bitbucket fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://gitlab.com/htr3n"><i class="fab fa-gitlab fa-lg" aria-hidden="true"></i></a>
	
	
	
	&nbsp;<a href="https://linkedin.com/in/htr3n"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://stackoverflow.com/users/339302"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	&nbsp;<a href="mailto:hoang.huy.tran&#43;blog@gmail.com"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
</section>

    </p>
    <p class="copyright">&copy; 2018 htr3n.
      <a href="https://creativecommons.org/licenses/by/4.0">Some Rights Reserved</a>.<br/>Built with <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
    </p>
  </div>
  <div>
  </div>
</div>

        <div class="content container">
            <div class="post">
  <h1>Confusing Hugo issues: datetime and &#39;isset&#39;</h1>
  
  <div class="col-sm-12 col-md-12">
    <span class="text-left post-date meta">
            
       
        <i class="fas fa-calendar-alt"></i> Mar 31, 2018
      
      
        
        
            in
            
            
                <a class="meta" href="/categories/dev">DEV</a>
                
            
        
      
      
      
        
        
            <br/>
             <i class="fas fa-tags"></i>
            
            <a class="meta" href="/tags/date/time">date/time</a> 
        
            <a class="meta" href="/tags/golang">golang</a> 
        
            <a class="meta" href="/tags/hugo">hugo</a> 
        
            <a class="meta" href="/tags/isset">isset</a> 
        
            <a class="meta" href="/tags/with">with</a>
        
      
      
      <br/>
      <i class="fas fa-clock"></i> 3 min read 
      </span>  
  </div>    
  
  <p>Yesterday I got notified from Github for <a href="https://github.com/htr3n/hyde-hyde/issues?q=is%3Aissue">two opening issues</a> of the Hugo&rsquo;s theme <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a> I have ported and developed.</p>

<p>The <a href="https://github.com/htr3n/hyde-hyde/issues/2">newest one</a> is reported by <a href="https://github.com/jdayton3">jdayton3</a> (Jonathan Dayton) on wrong dates shown up. The issue seems very strange and difficult to spot. It took me a while to research around and found some relevant reports by <a href="https://www.madboa.com/blog/2016/08/24/hugo-dateformat">Paul Heinlein</a> and <a href="https://github.com/gohugoio/hugo/issues/163">Dana Woodman</a>, that Hugo date/time formatting is internally based on Golang, and therefore, uses <a href="https://golang.org/pkg/time/#example_Time_Format">a smart but confusing convention</a>. It&rsquo;s funny that I made almost the same mistake as Dana (i.e. he used the format string &ldquo;March 1, 2010&rdquo; whilst mine is &ldquo;Jan 1, 2006&rdquo;). As such, the generated dates were totally incorrect.</p>

<p>Paul&rsquo;s post summarise excellently the Go&rsquo;s date/time format convention:</p>

<blockquote>
<p>Format strings absolutely must adhere to the 1-2-3-4-5-6-7 order:</p>

<ul>
<li>Month must be Jan, January, 01, or 1</li>
<li>Date must be 02 or 2</li>
<li>Hour must be 03, 3, or 15</li>
<li>Minute must 04</li>
<li>Second must be 05</li>
<li>Year must be 2006</li>
<li>Timezone must be MST or -7</li>
</ul>
</blockquote>

<p>After changing the format string, the aforementioned issue surely disappears. Even better, <code>hyde-hyde</code> date/time formatting can also now adopt a default option to prevent such potential issues.</p>

<pre><code>{{ .Date.Format (.Site.Params.dateformat | default &quot;Jan 02, 2006&quot;) }}
</code></pre>

<p><a href="https://github.com/htr3n/hyde-hyde/issues/1">The other issue</a> reported by <a href="https://github.com/paskal">paskal</a> (Dmitry Verkhoturov) is an error Dmitry spotted when compiling and testing his blog against several Hugo themes including mine, <code>hyde-hyde</code>.</p>

<pre><code>Building sites … ERROR 2018/03/20 20:35:56 Error while rendering &quot;page&quot; in &quot;&quot;: template: /srv/hugo/themes/hyde-hyde/layouts/_default/single.html:6:7: executing &quot;content&quot; at &lt;partial &quot;post_conten...&gt;: error calling partial: template: theme/partials/post_content.html:22:21: executing &quot;theme/partials/post_content.html&quot; at &lt;len .Params.tags&gt;: error calling len: len of untyped nil
ERROR 2018/03/20 20:35:56 Error while rendering &quot;page&quot; in &quot;post/&quot;: template: /srv/hugo/themes/hyde-hyde/layouts/_default/single.html:6:7: executing &quot;content&quot; at &lt;partial &quot;post_conten...&gt;: error calling partial: template: theme/partials/post_content.html:22:21: executing &quot;theme/partials/post_content.html&quot; at &lt;len .Params.tags&gt;: error calling len: len of untyped nil
</code></pre>

<p>The problem related to accessing <a href="https://gohugo.io/variables/page/#page-level-params">the tags</a> of each post via <code>.Params.tags</code>. The function <code>len .Params.tags</code> receives an untyped <code>nil</code> value. Strangely, there is a conditional check using the function <a href="https://github.com/gohugoio/hugo/blob/1823c053c8900cb6ee53b8e5c02939c7398e34dd/tpl/collections/collections.go#L315">isset</a> right before that.</p>

<pre><code>{{ if isset .Params &quot;tags&quot; }}
   {{ $total := len .Params.tags }}
   ...
{{ end }}
</code></pre>

<p>The <a href="https://gohugo.io/functions/isset">semantics</a> of <code>isset</code> is a bit vague:</p>

<blockquote>
<p>Returns true if the parameter is set.</p>
</blockquote>

<pre><code>isset COLLECTION INDEX
isset COLLECTION KEY
</code></pre>

<p>It does not say anything when either <code>COLLECTION</code> or <code>INDEX/KEY</code> is <code>nil</code> or empty. As such, perhaps Dmitry&rsquo;s blog contains some posts with empty tags. Hence, the variable <code>.Params.tags</code> yields <code>&quot;&quot;</code> whilst <code>isset.Params &quot;tags&quot;</code> evaluates to <code>true</code>.</p>

<p>One of the temporary mitigation is to use <a href="https://gohugo.io/functions/with">with</a> instead. The semantics of <code>with</code> is a bit clearer.</p>

<blockquote>
<p>Rebinds the context (<code>.</code>) within its scope and skips the block if the variable is absent.</p>
</blockquote>

<p>Nevertheless, the error is dismissed when replacing the above code with the following. Hoooraaay!!!</p>

<pre><code>{{ with .Params.tags }}
	{{ $total := len . }}
{{ end }}
</code></pre>

<p>Hugo is quite tricky, eh?</p>

  


<h3>See Also</h3>
  <ul>
	  
	    <li><a href="/2018/01/first-experience-with-hugo/">First experience with Hugo</a></li>
	  
  </ul>
  
</div>
            <div class="footer">
                <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

<script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
</script>

    

        <h2>Comments</h2>
        <div id="disqus_thread"></div>
<script type="text/javascript">
      (function () {
            
            
            
            if (location.hostname === "localhost" || 
            	location.hostname === "127.0.0.1" || 
            	location.hostname === "") {
                return;
			}
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            var disqus_shortname = 'https-htr3n-github-io';
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(
                  dsq);
      })();
</script>

<noscript>
	Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      

            </div>
        </div>
        
        
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-112764962-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </body>
</html>
